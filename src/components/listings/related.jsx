import Link from 'next/link'
import { getTranslations } from '@/i18n/server-i18n';

export default async function Related({ relatedTo, relatedFrom }) {

  const t = await getTranslations('Listings');

  if(relatedTo.length === 0 && relatedFrom.length === 0) {
    return (<p>{t('no-related')}</p>)
  }

  let singleRelationSet = [];
  relatedTo.forEach(relation => {
    singleRelationSet.push(relation)
  })
  relatedFrom.forEach(relation => {
    if(!singleRelationSet.find(thisRelation => thisRelation.slug === relation.slug)) {
      singleRelationSet.push(relation)
    }
  })

  return (
    <div className="grid grid-cols-3 gap-4 mt-4">
      {singleRelationSet.map((relation, i) => {
        return (
          <div key={`relation-${i}`} className="nld-bg-grey-50 rounded-xl p-4">
            <Link prefetch={false} href={`/listings/${relation.category}/${relation.slug}`}>
              <div className="flex items-center">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17.25 7.5C17.25 12.75 12 15.75 12 15.75C12 15.75 6.75 12.75 6.75 7.5C6.75 6.10761 7.30312 4.77226 8.28769 3.78769C9.27226 2.80312 10.6076 2.25 12 2.25C13.3924 2.25 14.7277 2.80312 15.7123 3.78769C16.6969 4.77226 17.25 6.10761 17.25 7.5Z" fill="#DEC170"/>
                  <path d="M18.3408 13.6514C18.5741 13.5391 18.842 13.5214 19.0879 13.6025L19.0967 13.6055C21.3646 14.4424 22.75 15.7118 22.75 17.25C22.75 18.0662 22.3695 18.7743 21.7471 19.3672C21.1278 19.957 20.2599 20.4436 19.248 20.8301C17.2233 21.6034 14.5661 22 12 22C9.43391 22 6.77674 21.6034 4.75195 20.8301C3.74015 20.4436 2.87221 19.957 2.25293 19.3672C1.63053 18.7743 1.25 18.0662 1.25 17.25C1.25 15.7117 2.63613 14.4425 4.9043 13.6064L4.91211 13.6035C5.15801 13.5224 5.42585 13.5401 5.65918 13.6523C5.8927 13.7648 6.07426 13.9639 6.16406 14.207C6.25378 14.4501 6.24492 14.7188 6.14062 14.9561C6.0363 15.1931 5.84419 15.3803 5.60449 15.4785L5.59668 15.4824C4.83836 15.7626 4.23654 16.0859 3.83008 16.4102C3.41247 16.7434 3.25 17.0363 3.25 17.25C3.25 17.4507 3.39327 17.7306 3.78223 18.0547C4.16236 18.3714 4.73744 18.6957 5.49805 18.9863C7.01709 19.5668 9.23596 20 12 20C14.764 20 16.9829 19.5668 18.502 18.9863C19.2626 18.6957 19.8376 18.3714 20.2178 18.0547C20.6067 17.7306 20.75 17.4507 20.75 17.25C20.75 17.0363 20.5878 16.7427 20.1699 16.4092C19.7634 16.0848 19.1617 15.7621 18.4033 15.4814L18.3955 15.4785C18.1558 15.3803 17.9637 15.1922 17.8594 14.9551C17.7551 14.7179 17.7462 14.4492 17.8359 14.2061C17.9257 13.9629 18.1073 13.7639 18.3408 13.6514Z" fill="#29646F"/>
                  <path d="M11.4258 6.11426C11.6999 6.00073 12.002 5.97142 12.293 6.0293C12.5838 6.08723 12.8509 6.22977 13.0605 6.43945C13.2702 6.64913 13.4128 6.91622 13.4707 7.20703C13.5286 7.498 13.4993 7.80013 13.3857 8.07422C13.2722 8.34823 13.0796 8.58229 12.833 8.74707C12.5864 8.91182 12.2966 9 12 9C11.6022 9 11.2208 8.84185 10.9395 8.56055C10.6581 8.27924 10.5 7.89782 10.5 7.5C10.5 7.2034 10.5882 6.91363 10.7529 6.66699C10.9177 6.42038 11.1518 6.2278 11.4258 6.11426Z" fill="#29646F"/>
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1.25C13.6576 1.25 15.2468 1.90895 16.4189 3.08105C17.591 4.25316 18.25 5.8424 18.25 7.5C18.25 10.3947 16.8593 12.6447 15.457 14.1777C14.0556 15.7097 12.6257 16.5445 12.501 16.6172L12.499 16.6182C12.3479 16.7045 12.177 16.75 12.0029 16.75C11.8289 16.75 11.658 16.7045 11.5068 16.6182C11.3756 16.5435 9.94508 15.71 8.54395 14.1797C7.14085 12.6472 5.75 10.397 5.75 7.5C5.75 5.8424 6.40895 4.25316 7.58105 3.08105C8.75316 1.90895 10.3424 1.25 12 1.25ZM12 3.25C10.8728 3.25 9.79215 3.69809 8.99512 4.49512C8.19809 5.29215 7.75 6.37283 7.75 7.5C7.75 9.40413 8.5581 10.9965 9.51855 12.2168C10.4039 13.3416 11.4106 14.1377 12 14.5537C12.5889 14.1381 13.5951 13.3425 14.4805 12.2178C15.4412 10.9973 16.25 9.40435 16.25 7.5C16.25 6.37283 15.8019 5.29215 15.0049 4.49512C14.2079 3.69809 13.1272 3.25 12 3.25Z" fill="#29646F"/>
                </svg>
                <div className="ml-4">
                  <h5 className="nld-font-jost nld-text-teal-500 nld-font-h6 uppercase">{relation.category}</h5>
                  <h5 className="nld-text-grey-500 nld-font-h5">{relation.name}</h5>
                  {relation.description ? <h5 className="nld-text-grey-300 nld-font-h6">{relation.description}</h5> : false}
                </div>
              </div>
            </Link>
          </div>
        )
        return false;
      })}
    </div>
  );
}
